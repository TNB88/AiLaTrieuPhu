<script>
    // --- C·∫§U H√åNH D·ªÆ LI·ªÜU ---
    const moneyTree = [
        "200.000", "400.000", "600.000", "1.000.000", "2.000.000", 
        "3.000.000", "6.000.000", "10.000.000", "14.000.000", "22.000.000",
        "30.000.000", "40.000.000", "60.000.000", "85.000.000", "150.000.000"
    ];

    const questions = [
        { q: "Ai l√† ng∆∞·ªùi t·∫°o ra tool SilverBullet?", a: ["D√¢n IT", "B√¨nh Pro", "OpenBullet Team", "Hacker Nga"], correct: 2 },
        { q: "Con v·∫≠t n√†o sau ƒë√¢y kh√¥ng th·ªÉ nh·∫£y?", a: ["Voi", "Ch√≥", "M√®o", "Chu·ªôt t√∫i"], correct: 0 },
        { q: "Th·ªß ƒë√¥ c·ªßa Vi·ªát Nam l√† g√¨?", a: ["TP.HCM", "Hu·∫ø", "H√† N·ªôi", "C·∫ßn Th∆°"], correct: 2 },
        { q: "Trong Dragon Ball, ai l√† cha c·ªßa Gohan?", a: ["Vegeta", "Goku", "Piccolo", "Yamcha"], correct: 1 },
        { q: "B√¨nh Pro ƒë·∫πp trai nh·∫•t x√≥m n√†o?", a: ["X√≥m Ch√πa", "X√≥m L√°", "X√≥m Code", "C·∫£ Th·∫ø Gi·ªõi"], correct: 3 },
    ];

    let currentLevel = 0;
    let isGameRunning = false;

    // --- KHAI B√ÅO √ÇM THANH (D√πng file trong m√°y cho ·ªïn ƒë·ªãnh) ---
    // √îng nh·ªõ t·∫£i file v·ªÅ v√† ƒë·ªÉ c√πng th∆∞ m·ª•c nh√©
    const sounds = {
        intro: new Audio('intro.mp3'),
        correct: new Audio('correct.mp3'),
        wrong: new Audio('wrong.mp3')
    };
    
    sounds.intro.loop = true; // Nh·∫°c n·ªÅn l·∫∑p l·∫°i

    // --- LOGIC GAME ---

    function startGame() {
        document.getElementById('start-screen').style.display = 'none';
        
        // K√≠ch ho·∫°t nh·∫°c n·ªÅn (Chrome y√™u c·∫ßu ph·∫£i c√≥ t∆∞∆°ng t√°c m·ªõi cho ph√°t)
        sounds.intro.play().catch(e => console.log("Ch∆∞a c√≥ file intro.mp3 ho·∫∑c l·ªói Autoplay"));
        
        currentLevel = 0;
        renderMoneyLadder();
        loadQuestion();
        isGameRunning = true;
    }

    function renderMoneyLadder() {
        const ladder = document.getElementById('moneyLadder');
        ladder.innerHTML = '';
        for (let i = moneyTree.length - 1; i >= 0; i--) {
            const div = document.createElement('div');
            div.className = `money-step ${i === currentLevel ? 'active' : ''}`;
            div.innerText = `${i + 1}. ${moneyTree[i]} VND`;
            ladder.appendChild(div);
        }
    }

    function loadQuestion() {
        if (currentLevel >= questions.length) {
            endGame(true); 
            return;
        }

        const qData = questions[currentLevel];
        document.getElementById('questionText').innerText = `C√¢u ${currentLevel + 1}: ${qData.q}`;
        
        for (let i = 0; i < 4; i++) {
            const btn = document.getElementById(`btn${i}`);
            btn.innerText = String.fromCharCode(65 + i) + ": " + qData.a[i];
            btn.className = 'answer-btn'; 
            btn.style.visibility = 'visible';
            btn.disabled = false;
        }
        renderMoneyLadder();
    }

    function checkAnswer(index) {
        if (!isGameRunning) return;
        
        const correctIndex = questions[currentLevel].correct;
        const selectedBtn = document.getElementById(`btn${index}`);
        const correctBtn = document.getElementById(`btn${correctIndex}`);

        selectedBtn.classList.add('selected');

        setTimeout(() => {
            selectedBtn.classList.remove('selected');
            
            if (index === correctIndex) {
                // --- ƒê√öNG: Ph√°t nh·∫°c ƒë√∫ng ---
                sounds.correct.play().catch(e => {}); 
                selectedBtn.classList.add('correct');
                
                setTimeout(() => {
                    currentLevel++;
                    loadQuestion();
                }, 1500); // ƒê·ª£i nh·∫°c ƒë√∫ng ch·∫°y m·ªôt ch√∫t r·ªìi qua c√¢u m·ªõi
            } else {
                // --- SAI: Ph√°t nh·∫°c sai ---
                sounds.intro.pause(); // D·ª´ng nh·∫°c n·ªÅn cho k·ªãch t√≠nh
                sounds.wrong.play().catch(e => {});
                
                selectedBtn.classList.add('wrong');
                correctBtn.classList.add('correct'); 
                setTimeout(() => {
                    endGame(false);
                }, 2000);
            }
        }, 1000); // Th·ªùi gian ch·ªù h·ªìi h·ªôp
    }

    function endGame(isWin) {
        sounds.intro.pause();
        sounds.intro.currentTime = 0;

        isGameRunning = false;
        const resultScreen = document.getElementById('result-screen');
        const resultTitle = document.getElementById('result-title');
        const resultMoney = document.getElementById('result-money');

        resultScreen.style.display = 'flex';
        
        let moneyStr = "0";
        if (isWin) {
            resultTitle.innerText = "CH√öC M·ª™NG T·ª∂ PH√ö B√åNH PRO!";
            moneyStr = moneyTree[questions.length - 1];
        } else {
            resultTitle.innerText = "RA V·ªÄ TI·∫æC NU·ªêI...";
            if (currentLevel > 0) moneyStr = moneyTree[currentLevel - 1];
        }
        resultMoney.innerText = `Ti·ªÅn th∆∞·ªüng: ${moneyStr} VND`;
    }

    // --- QUY·ªÄN TR·ª¢ GI√öP (Gi·ªØ nguy√™n) ---
    function use5050() { /* ... (Gi·ªØ nguy√™n code c≈©) ... */ 
        const btn = document.getElementById('help5050');
        if (btn.classList.contains('used')) return;
        const correct = questions[currentLevel].correct;
        let removed = 0;
        while (removed < 2) {
            let rand = Math.floor(Math.random() * 4);
            if (rand !== correct && document.getElementById(`btn${rand}`).style.visibility !== 'hidden') {
                document.getElementById(`btn${rand}`).style.visibility = 'hidden';
                removed++;
            }
        }
        btn.classList.add('used');
    }

    function useCall() { /* ... (Gi·ªØ nguy√™n code c≈©) ... */
        const btn = document.getElementById('helpCall');
        if (btn.classList.contains('used')) return;
        const correctChar = String.fromCharCode(65 + questions[currentLevel].correct);
        alert(`üìû B√°c L·∫°i VƒÉn S√¢m: "Tin b√°c ƒëi, ch·ªçn ${correctChar}!"`);
        btn.classList.add('used');
    }

    function useAsk() { /* ... (Gi·ªØ nguy√™n code c≈©) ... */
        const btn = document.getElementById('helpAsk');
        if (btn.classList.contains('used')) return;
        alert("üìä Kh√°n gi·∫£ 100% ch·ªçn ƒë√°p √°n ƒë√∫ng!");
        btn.classList.add('used');
    }
</script>
