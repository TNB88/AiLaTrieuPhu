<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ai Là Triệu Phú - Bình Pro</title>
    <style>
        body {
            background-color: #020b1c;
            color: #fff;
            font-family: 'Arial', sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            height: 100vh;
            margin: 0;
            overflow: hidden;
            touch-action: manipulation;
            -webkit-tap-highlight-color: transparent;
        }

        /* --- MÀN HÌNH CHỜ --- */
        #start-screen {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(2, 11, 28, 1);
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            z-index: 999; text-align: center;
        }
        .btn-big {
            padding: 20px 40px; font-size: 22px; background: #28a745; color: white;
            border: none; border-radius: 50px; font-weight: bold;
            box-shadow: 0 0 20px #28a745; cursor: pointer; animation: pulse 1.5s infinite;
            margin-top: 20px;
        }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }
        
        #debug-log {
            margin-top: 10px; font-size: 11px; color: yellow; opacity: 0.7;
        }

        /* --- BẢNG TIỀN (THIẾT KẾ MỚI) --- */
        .money-ladder-container {
            position: absolute;
            right: 10px; top: 10px;
            z-index: 50;
        }

        .money-ladder { 
            background: rgba(0,0,0,0.9); padding: 5px; 
            border-radius: 8px; font-size: 12px; 
            border: 1px solid #f0ad4e; 
            display: flex; flex-direction: column-reverse; /* Để số nhỏ ở dưới */
            min-width: 120px;
            transition: all 0.3s ease;
        }

        .money-step {
            padding: 3px 10px;
            color: #888;
            border-bottom: 1px solid #333;
            /* Hiệu ứng ẩn hiện */
            opacity: 0; 
            transform: translateY(20px);
            transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275); /* Hiệu ứng nảy */
        }
        .money-step.show { opacity: 1; transform: translateY(0); }
        .money-step.active { background: #f0ad4e; color: #000; font-weight: bold; transform: scale(1.05); border-radius: 4px; z-index: 2; }
        
        /* Mốc quan trọng */
        .milestone { color: #fff !important; }

        /* --- GIAO DIỆN GAME --- */
        .game-container { 
            width: 95%; max-width: 600px; 
            text-align: center; 
            display: flex; flex-direction: column; gap: 5px; align-items: center; 
            justify-content: center;
            height: 100%;
            padding-top: 40px; /* Chừa chỗ cho header nếu cần */
        }

        .question-image {
            max-width: 80%; /* Thu nhỏ ảnh chút cho thoáng */
            max-height: 25vh; /* Giới hạn chiều cao theo màn hình */
            height: auto;
            border-radius: 10px; 
            border: 2px solid #f0ad4e;
            box-shadow: 0 0 10px #f0ad4e;
            object-fit: contain;
            margin-bottom: 5px;
        }

        .question-box { background: #003366; border: 2px solid #fff; border-radius: 10px; padding: 10px; font-size: 15px; font-weight: bold; min-height: 70px; display: flex; align-items: center; justify-content: center; width: 100%; }
        .answers-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; width: 100%; flex-grow: 1; max-height: 200px; }
        .answer-btn { background: #001a33; border: 1px solid #aaa; border-radius: 15px; padding: 5px; color: white; font-size: 13px; display: flex; align-items: center; justify-content: center; height: 100%; }
        .answer-btn.selected { background: #f0ad4e; color: black; }
        .answer-btn.correct { background: #28a745 !important; }
        .answer-btn.wrong { background: #dc3545 !important; }

        #result-screen { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); display: none; flex-direction: column; justify-content: center; align-items: center; z-index: 100; }

        /* --- RESPONSIVE CHO ĐIỆN THOẠI (FIX LỖI CHE ẢNH) --- */
        @media (max-width: 600px) {
            /* Biến bảng tiền thành 1 dòng nhỏ gọn ở trên cùng */
            .money-ladder-container {
                right: 50%;
                transform: translateX(50%);
                top: 5px;
                width: 90%;
            }
            .money-ladder {
                flex-direction: column; /* Vẫn giữ dọc nhưng ẩn bớt */
                height: 30px; /* Chỉ hiện 1 dòng */
                overflow: hidden;
                border: 1px solid #444;
                background: rgba(0,0,0,0.8);
            }
            /* Khi bấm vào thì xổ ra */
            .money-ladder.expanded {
                height: auto;
                max-height: 60vh;
                overflow-y: auto;
            }
            /* Chỉ hiện mốc đang active, ẩn mấy cái kia đi */
            .money-step { display: none; padding: 5px; text-align: center; }
            .money-step.active { display: block; width: 100%; margin: 0; }
            .money-ladder.expanded .money-step { display: block; } /* Xổ ra thì hiện hết */
            
            /* Chỉnh lại ảnh và câu hỏi cho vừa màn hình */
            .question-image { max-height: 20vh; margin-top: 30px; }
            .question-box { font-size: 14px; min-height: 60px; }
            .answers-grid { height: 160px; }
        }
    </style>
</head>
<body>

    <div id="start-screen">
        <h1 style="color: #f0ad4e; margin-bottom: 5px;">AI LÀ TRIỆU PHÚ</h1>
        <p style="color: #ccc; font-size: 12px;">Phiên bản: Bình Pro Mobile</p>
        <button id="btn-start" class="btn-big" onclick="unlockAudio()">BẤM ĐỂ CHƠI</button>
        <div id="debug-log">Trạng thái: Chờ kích hoạt...</div>
    </div>

    <div id="result-screen">
        <h1 id="result-title">GAME OVER</h1>
        <h2 id="result-money">0 VND</h2>
        <button class="answer-btn" style="width: 150px; height: 50px; margin-top: 20px;" onclick="location.reload()">CHƠI LẠI</button>
    </div>
    
    <div class="money-ladder-container" onclick="toggleLadder()">
        <div class="money-ladder" id="moneyLadder"></div>
    </div>

    <div class="game-container">
        <img src="https://cand.com.vn/Files/Image/chienthang/2019/05/19/88cdec2f-1c8b-4436-b6c9-26e99f75b5d5.jpg" alt="Ảnh minh họa" class="question-image">
        
        <div class="question-box" id="questionText">Đang tải dữ liệu...</div>
        
        <div class="answers-grid">
            <button class="answer-btn" onclick="checkAnswer(0)" id="btn0"></button>
            <button class="answer-btn" onclick="checkAnswer(1)" id="btn1"></button>
            <button class="answer-btn" onclick="checkAnswer(2)" id="btn2"></button>
            <button class="answer-btn" onclick="checkAnswer(3)" id="btn3"></button>
        </div>
    </div>

    <script>
        function log(msg) { document.getElementById('debug-log').innerText = "Log: " + msg; console.log(msg); }
        
        const moneyTree = ["200K", "400K", "600K", "1Tr", "2Tr", "3Tr", "6Tr", "10Tr", "14Tr", "22Tr", "30Tr", "40Tr", "60Tr", "85Tr", "150 TỶ"];
        const questions = [
            { q: "Trần Âu Thường Mượn Tiền Ai?", a: ["Đào Ngọc Thảo", "Nguyên Bình", "Hoàng Anh", "A Và B"], correct: 3 },
            { q: "Đào Ngọc Thảo đi chợ ngày bao nhiêu tiền?", a: ["500.000", "1.000.000", "50.000", "200.000"], correct: 2 },
            { q: "Thảo Có Xinh Đẹp Không?", a: ["Rất Xinh Đẹp", "Trông Ok", "Ưu Nhìn", "Xấu Như Mắm"], correct: 0 },
            { q: "Trong ảnh là Chủ tịch nào?", a: ["Hồ Chí Minh", "Tôn Đức Thắng", "Võ Nguyên Giáp", "Phạm Văn Đồng"], correct: 0 },
            { q: "Bình Pro có đẹp trai không?", a: ["Không", "Bình thường", "Siêu cấp", "Quá đẹp"], correct: 3 }
        ];

        // Link âm thanh
        const audioSrc = {
            intro: "https://raw.githubusercontent.com/Liozon/WhoWantsToBeAMillionaire-Soundboard/refs/heads/main/sounds/candidate's%20arriving.mp3",
            correct: "https://raw.githubusercontent.com/Liozon/WhoWantsToBeAMillionaire-Soundboard/refs/heads/main/sounds/correct%20answer.mp3",
            wrong: "https://raw.githubusercontent.com/Liozon/WhoWantsToBeAMillionaire-Soundboard/refs/heads/main/sounds/wrong%20answer.mp3"
        };
        let sounds = { intro: new Audio(audioSrc.intro), correct: new Audio(audioSrc.correct), wrong: new Audio(audioSrc.wrong) };
        sounds.intro.loop = true; 
        
        let currentLevel = 0; let isGameRunning = false;

        function unlockAudio() {
            log("Đang vào game...");
            try {
                let p = sounds.intro.play();
                if(p !== undefined) p.catch(e => log("Lỗi nhạc: " + e));
                sounds.correct.play().then(()=>sounds.correct.pause());
                sounds.wrong.play().then(()=>sounds.wrong.pause());
                
                document.getElementById('start-screen').style.display = 'none';
                
                // Bắt đầu game và chạy hiệu ứng
                initGame();
            } catch (err) { log("Lỗi: " + err); }
        }

        function initGame() {
            currentLevel = 0;
            isGameRunning = true;
            // Render lần đầu có hiệu ứng chạy
            renderMoneyLadder(true); 
            loadQuestion();
        }

        function toggleLadder() {
            const el = document.getElementById('moneyLadder');
            el.classList.toggle('expanded');
        }

        function renderMoneyLadder(animate = false) {
            const ladder = document.getElementById('moneyLadder');
            ladder.innerHTML = '';
            
            // Xây thang tiền
            for (let i = 0; i < moneyTree.length; i++) {
                const div = document.createElement('div');
                div.className = `money-step ${i === currentLevel ? 'active' : ''}`;
                if(i===4 || i===9 || i===14) div.classList.add('milestone');
                div.innerText = `${i + 1}. ${moneyTree[i]}`;
                
                // Hiệu ứng chạy từ dưới lên
                if (animate) {
                    div.style.transitionDelay = `${i * 100}ms`; // Mỗi nấc trễ 100ms
                } else {
                    div.classList.add('show'); // Hiện luôn
                }
                
                // Chèn lên đầu (để số lớn ở trên) nhưng CSS flex-reverse sẽ đảo lại cho đúng chiều
                ladder.insertBefore(div, ladder.firstChild); 
            }

            // Kích hoạt hiệu ứng sau khi render
            if (animate) {
                // Mở rộng bảng tiền trong lúc chạy hiệu ứng để người chơi thấy
                ladder.classList.add('expanded');
                
                setTimeout(() => {
                    const steps = document.querySelectorAll('.money-step');
                    steps.forEach(s => s.classList.add('show'));
                }, 50);

                // Sau khi chạy xong (khoảng 2s) thì thu gọn lại
                setTimeout(() => {
                    ladder.classList.remove('expanded');
                }, 2500);
            }
        }

        function loadQuestion() {
            if (currentLevel >= questions.length) { endGame(true); return; }
            const qData = questions[currentLevel];
            document.getElementById('questionText').innerText = `Câu ${currentLevel + 1}: ${qData.q}`;
            for (let i = 0; i < 4; i++) {
                const btn = document.getElementById(`btn${i}`);
                btn.innerText = `➤ ${qData.a[i]}`; btn.className = 'answer-btn'; btn.style.visibility = 'visible';
            }
            // Render lại để cập nhật mốc vàng, không chạy lại hiệu ứng
            renderMoneyLadder(false);
        }

        function checkAnswer(index) {
            if (!isGameRunning) return;
            const correctIndex = questions[currentLevel].correct;
            const selectedBtn = document.getElementById(`btn${index}`);
            selectedBtn.classList.add('selected');
            setTimeout(() => {
                selectedBtn.classList.remove('selected');
                if (index === correctIndex) {
                    sounds.correct.currentTime = 0; sounds.correct.play();
                    selectedBtn.classList.add('correct');
                    setTimeout(() => { currentLevel++; loadQuestion(); }, 1500);
                } else {
                    sounds.intro.pause(); sounds.wrong.currentTime = 0; sounds.wrong.play();
                    selectedBtn.classList.add('wrong'); 
                    document.getElementById(`btn${questions[currentLevel].correct}`).classList.add('correct');
                    setTimeout(() => endGame(false), 2000);
                }
            }, 1000);
        }

        function endGame(isWin) {
            isGameRunning = false; sounds.intro.pause();
            document.getElementById('result-screen').style.display = 'flex';
            document.getElementById('result-title').innerText = isWin ? "BÌNH PRO VÔ ĐỊCH!" : "THUA RỒI...";
            let money = "0";
            if(isWin) money = moneyTree[moneyTree.length - 1]; else if(currentLevel > 0) money = moneyTree[currentLevel - 1];
            document.getElementById('result-money').innerText = `Tiền thưởng: ${money}`;
        }
    </script>
</body>
</html>
