<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ai Là Triệu Phú - Bình Pro</title>
    <style>
        body {
            background-color: #020b1c;
            color: #fff;
            font-family: 'Arial', sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
            overflow: hidden;
            touch-action: manipulation;
            -webkit-tap-highlight-color: transparent;
        }

        /* Màn hình Start */
        #start-screen {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(2, 11, 28, 1);
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            z-index: 999; text-align: center;
        }

        .btn-big {
            padding: 20px 40px;
            font-size: 22px;
            background: #28a745;
            color: white;
            border: none;
            border-radius: 50px;
            font-weight: bold;
            box-shadow: 0 0 20px #28a745;
            cursor: pointer;
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }

        /* Debug Box - Để ông biết lỗi ở đâu */
        #debug-log {
            margin-top: 20px; font-size: 12px; color: yellow;
            background: rgba(0,0,0,0.5); padding: 10px; border-radius: 5px;
            max-width: 90%; word-wrap: break-word;
        }

        /* Giao diện Game */
        .money-ladder { position: absolute; right: 5px; top: 5px; background: rgba(0,0,0,0.8); padding: 5px; border-radius: 5px; font-size: 11px; max-height: 25vh; overflow-y: auto; border: 1px solid #f0ad4e; }
        .money-step.active { background: #f0ad4e; color: #000; font-weight: bold; }

        .game-container { width: 95%; max-width: 600px; text-align: center; display: flex; flex-direction: column; gap: 10px; }
        .question-box { background: #003366; border: 2px solid #fff; border-radius: 10px; padding: 15px; font-size: 16px; font-weight: bold; min-height: 80px; display: flex; align-items: center; justify-content: center; }
        .answers-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }
        .answer-btn { background: #001a33; border: 1px solid #aaa; border-radius: 15px; padding: 15px 5px; color: white; font-size: 14px; min-height: 50px; }
        .answer-btn.selected { background: #f0ad4e; color: black; }
        .answer-btn.correct { background: #28a745 !important; }
        .answer-btn.wrong { background: #dc3545 !important; }
        #result-screen { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); display: none; flex-direction: column; justify-content: center; align-items: center; z-index: 100; }
    </style>
</head>
<body>

    <div id="start-screen">
        <h1 style="color: #f0ad4e">AI LÀ TRIỆU PHÚ</h1>
        <p style="color: #ccc; font-size: 14px; margin-bottom: 20px;">Lưu ý: Gạt nút RUNG bên hông máy lên!</p>
        
        <button id="btn-start" class="btn-big" onclick="unlockAudio()">BẤM ĐỂ CHƠI</button>
        
        <div id="debug-log">Trạng thái: Đang chờ...</div>
    </div>

    <div id="result-screen">
        <h1 id="result-title">GAME OVER</h1>
        <h2 id="result-money">0 VND</h2>
        <button class="answer-btn" style="width: 150px; margin-top: 20px;" onclick="location.reload()">CHƠI LẠI</button>
    </div>
    <div class="money-ladder" id="moneyLadder"></div>
    <div class="game-container">
        <div class="question-box" id="questionText">Loading...</div>
        <div class="answers-grid">
            <button class="answer-btn" onclick="checkAnswer(0)" id="btn0"></button>
            <button class="answer-btn" onclick="checkAnswer(1)" id="btn1"></button>
            <button class="answer-btn" onclick="checkAnswer(2)" id="btn2"></button>
            <button class="answer-btn" onclick="checkAnswer(3)" id="btn3"></button>
        </div>
    </div>

    <script>
        // --- LOG SYSTEM (Để ông xem nó bị gì) ---
        function log(msg) {
            document.getElementById('debug-log').innerText = "Log: " + msg;
            console.log(msg);
        }

        // --- DATA ---
        const moneyTree = ["200K", "400K", "600K", "1Tr", "2Tr", "3Tr", "6Tr", "10Tr", "14Tr", "22Tr", "30Tr", "40Tr", "60Tr", "85Tr", "150 TỶ"];
        const questions = [
            { q: "Nút gạt rung của iPhone nằm ở đâu?", a: ["Trên đỉnh", "Dưới đáy", "Bên hông trái", "Không có"], correct: 2 },
            { q: "Tool SilverBullet dùng để làm gì?", a: ["Nấu ăn", "Check Acc", "Đào Bitcoin", "Chơi Game"], correct: 1 },
            { q: "1 + 1 bằng mấy?", a: ["1", "2", "3", "11"], correct: 1 },
            { q: "Bình Pro có đẹp trai không?", a: ["Không", "Bình thường", "Siêu cấp", "Quá đẹp"], correct: 3 },
            { q: "Thủ đô Việt Nam?", a: ["HCM", "Hà Nội", "Đà Nẵng", "Cần Thơ"], correct: 1 }
        ];

        // --- AUDIO SYSTEM (Dùng Audio thuần để dễ load) ---
        // Link dự phòng khác ổn định hơn
        const audioSrc = {
            intro: "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3", // Nhạc dài demo
            correct: "https://assets.mixkit.co/active_storage/sfx/2000/2000-preview.mp3",
            wrong: "https://assets.mixkit.co/active_storage/sfx/2003/2003-preview.mp3"
        };

        let sounds = {
            intro: new Audio(audioSrc.intro),
            correct: new Audio(audioSrc.correct),
            wrong: new Audio(audioSrc.wrong)
        };
        
        // Cấu hình nhạc
        sounds.intro.loop = true;
        sounds.intro.volume = 1.0; 

        // Kiểm tra tải nhạc
        sounds.intro.addEventListener('canplaythrough', () => log("Nhạc nền đã tải xong!"));
        sounds.intro.addEventListener('error', (e) => log("Lỗi tải nhạc nền! Kiểm tra mạng."));

        let currentLevel = 0;
        let isGameRunning = false;

        // --- HÀM QUAN TRỌNG: KÍCH HOẠT ÂM THANH ---
        function unlockAudio() {
            log("Đang kích hoạt âm thanh...");
            
            // 1. Phát thử TẤT CẢ âm thanh ngay lập tức (bắt buộc trong sự kiện click)
            try {
                // Intro: Phát luôn
                let playPromise = sounds.intro.play();
                
                if (playPromise !== undefined) {
                    playPromise.then(_ => {
                        log("Nhạc nền ĐANG PHÁT! (Nếu không nghe thấy => Gạt nút rung lên)");
                    })
                    .catch(error => {
                        log("Trình duyệt chặn nhạc: " + error);
                    });
                }

                // Effect: Phát 0s rồi dừng để "mở khóa"
                sounds.correct.play().then(() => sounds.correct.pause());
                sounds.wrong.play().then(() => sounds.wrong.pause());

                // 2. Vào game
                document.getElementById('start-screen').style.display = 'none';
                initGame();

            } catch (err) {
                log("Lỗi Unlock: " + err);
            }
        }

        function initGame() {
            currentLevel = 0;
            isGameRunning = true;
            renderMoneyLadder();
            loadQuestion();
        }

        function renderMoneyLadder() {
            const ladder = document.getElementById('moneyLadder');
            ladder.innerHTML = '';
            let start = Math.max(0, currentLevel - 2);
            let end = Math.min(moneyTree.length, currentLevel + 3);
            for (let i = moneyTree.length - 1; i >= 0; i--) {
                const div = document.createElement('div');
                div.className = `money-step ${i === currentLevel ? 'active' : ''}`;
                div.innerText = `${i + 1}. ${moneyTree[i]}`;
                if(i===4 || i===9 || i===14) div.style.color = "#f0ad4e";
                ladder.appendChild(div);
            }
        }

        function loadQuestion() {
            if (currentLevel >= questions.length) { endGame(true); return; }
            const qData = questions[currentLevel];
            document.getElementById('questionText').innerText = `Câu ${currentLevel + 1}: ${qData.q}`;
            for (let i = 0; i < 4; i++) {
                const btn = document.getElementById(`btn${i}`);
                btn.innerText = `➤ ${qData.a[i]}`;
                btn.className = 'answer-btn'; 
                btn.style.visibility = 'visible';
            }
            renderMoneyLadder();
        }

        function checkAnswer(index) {
            if (!isGameRunning) return;
            const correctIndex = questions[currentLevel].correct;
            const selectedBtn = document.getElementById(`btn${index}`);
            
            selectedBtn.classList.add('selected');
            
            setTimeout(() => {
                selectedBtn.classList.remove('selected');
                if (index === correctIndex) {
                    // PHÁT ĐÚNG
                    sounds.correct.currentTime = 0;
                    sounds.correct.play().catch(e => log("Lỗi tiếng đúng: " + e));
                    
                    selectedBtn.classList.add('correct');
                    setTimeout(() => { currentLevel++; loadQuestion(); }, 1500);
                } else {
                    // PHÁT SAI
                    sounds.intro.pause();
                    sounds.wrong.currentTime = 0;
                    sounds.wrong.play().catch(e => log("Lỗi tiếng sai: " + e));
                    
                    selectedBtn.classList.add('wrong');
                    document.getElementById(`btn${questions[currentLevel].correct}`).classList.add('correct');
                    setTimeout(() => endGame(false), 2000);
                }
            }, 1000);
        }

        function endGame(isWin) {
            isGameRunning = false;
            sounds.intro.pause();
            document.getElementById('result-screen').style.display = 'flex';
            document.getElementById('result-title').innerText = isWin ? "BÌNH PRO VÔ ĐỊCH!" : "THUA RỒI...";
            let money = "0";
            if(isWin) money = moneyTree[moneyTree.length - 1];
            else if(currentLevel > 0) money = moneyTree[currentLevel - 1];
            document.getElementById('result-money').innerText = `Tiền: ${money}`;
        }
    </script>
</body>
</html>
